<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    />

    <style>
      .hide {
        display: none;
      }
      .user-list-container {
        justify-content: space-between;
        align-items: center;
        width: 100%;
        background-color: white;
        border: 3px solid black;
        margin-bottom: 30px;
      }
      .user-list-item {
        font-size: larger;
        text-align: left;
        min-width: 150px;
        padding: 20px;
        margin: 20px;
      }
    </style>
  </head>
  <body>
   
    <div class="container container-fluid mt-5">
      <h1>Admin Panel</h1>
      <div class="container container-fluid mt-5 bg-light p-5">
        <% if (messages.error) { %>
        <p style="color: red"><%- messages.error %></p>
        <% } %> <% if (messages.success) { %>
        <p style="color: green"><%- messages.success %></p>
        <% } %>
        <div class="container container-fluid mt-5">
          <div class="card">
            <div class="card-header">Dashboard</div>
            <div class="card-body">
              <h5 class="card-title">Welcome</h5>
              <p class="card-text">
                Login Successful. You can manage users from here.
              </p>
              <a href="/logout" class="btn btn-danger">Logout</a>
            </div>
          </div>
        </div>
        <div class="container container-fluid mt-5 bg-light p-5">
          <% if (messages.error) { %>
          <p style="color: red"><%- messages.error %></p>
          <% } %> <% if (messages.success) { %>
          <p style="color: green"><%- messages.success %></p>
          <% } %>
          <form action="/register" method="post" name="form1" id="form">
            <h3>Add User</h3>
            <div class="form-group">
              <label for="exampleInputEmail1">Name</label>
              <input
                type="name"
                name="name"
                class="form-control"
                id="name"
                aria-describedby="nameHelp"
                placeholder="Enter name"
                value=""
                required
              />
            </div>
            <div class="form-group">
              <label for="exampleInputEmail1">Email</label>
              <input
                type="email"
                name="email"
                class="form-control"
                id="email"
                aria-describedby="emailHelp"
                placeholder="Enter email"
                value=""
                required
              />
            </div>
            <div class="form-group">
              <label for="exampleInputEmail1">Password</label>
              <input
                type="password"
                name="password"
                class="form-control"
                id="password"
                aria-describedby="emailHelp"
                placeholder="*********"
                value=""
                required
              />
            </div>
            <input type="submit" class="btn btn-success" value="Add User" />
          </form>
        </div>
        <form method="post" action="/deleteuser" id="deleteform">
          <div class="container container-fluid mt-5">
            <h3 class="mb-5">Users List</h3>
            <div class="d-flex container user-list-container">
              <div
                class="title d-inline-block user-list-item"
                style="font-size: 1.2rem; font-weight: 800"
              >
                User Name
              </div>
              <div
                class="title d-inline-block user-list-item"
                style="font-size: 1.2rem; font-weight: 800"
              >
                Email id
              </div>
              <div
                class="title d-inline-block user-list-item"
                style="font-size: 1.2rem; font-weight: 800"
              >
                Delete User
              </div>
            </div>
            <% if (result.length > 0) { %> <% result.forEach(user => { let
            userId = user.email %>
            <div class="d-flex container user-list-container">
              <div class="title d-inline-block user-list-item">
                <%= user.name %>
              </div>
              <div class="title d-inline-block user-list-item">
                <%= user.email %>
              </div>
              <button
               
                name="id"
                value="<%= user.email %>"
                class="d-inline-block btn btn-danger"
                type="submit"
                form="deleteform"
              >
                Delete User
              </button>
            </div>
            <% }) %> <% } %>
          </div>
        </form>

        <div class="search-wrapper">
          <form action="/searchusers" method="post" name="form1" id="searchform">
            <h3>Search Users<//h3>
            <div class="form-group">
              <label for="exampleInputEmail1">Name</label>
              <input
                type="search"
                name="search"
                class="form-control"
                id="name"
                aria-describedby="nameHelp"
                placeholder="Search user by email"
                value=""
                required
              />
            </div>
          </form>
            <input type="submit" class="btn btn-success" value="Search User" />
        
          <div class="container container-fluid mt-5">
            <form action="/deleteuser" method="post" name="form1" id="deleteform">
            <h3 class="mb-5">Users List</h3>
            <div class="d-flex container user-list-container">
              <div
                class="title d-inline-block user-list-item"
                style="font-size: 1.2rem; font-weight: 800"
              >
                User Name
              </div>
              <div
                class="title d-inline-block user-list-item"
                style="font-size: 1.2rem; font-weight: 800"
              >
                Email id
              </div>
              <div
                class="title d-inline-block user-list-item"
                style="font-size: 1.2rem; font-weight: 800"
              >
                Delete User
              </div>
            </div>
            <% if (newResult.length > 0) { %> <% newResult.forEach(user => { let
            userId = user.email %>
            <div class="d-flex container user-list-container">
              <div class="title d-inline-block user-list-item">
                <%= user.name %>
              </div>
              <div class="title d-inline-block user-list-item">
                <%= user.email %>
              </div>
              <button
                name="id"
                value="<%= user.email %>"
                class="d-inline-block btn btn-danger"
                id="DeleteUser"
                type="submit"
                form="deleteform"
              >
                Delete User
              </button>
            </div>
            <% }) %> <% } %>
          </form>
          </div>
        </div>
      </div>
    </div>
    <script>
//       function deleteUser() {
//         var result = confirm("Want to delete?");
//           if (result) {
//               console.log("Hi");
//           }else {
//             console.log("Lol");
//             return;
//           }
// }
document.getElementById('deleteform').addEventListener(
 'submit', 
 (e) => checker(e)
)

function checker(e) {
 if(confirm('Are you sure?')) {
  return true;
 }else {
  e.preventDefault()
   alert('Form was not submitted')
 }
}  
    </script>
  </body>
</html>
